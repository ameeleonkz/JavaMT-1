# README.md

# Custom Thread Pool

Этот проект представляет собой реализацию пула потоков с настраиваемыми параметрами, который позволяет эффективно управлять распределением задач между потоками. Пул потоков разработан с учетом высоких нагрузок и гибкости в настройках.

## Установка

1. Соберите проект с помощью Maven:
   ```
   mvn clean install
   ```

2. Запустите проект с помощью Maven:
   ```
   mvn compile exec:java -DskipTests -Dexec.mainClass=Main > log
   ```

## Дополнительно

В качестве стратегии обработки отказа в этом проекте выбрана адаптивная:

- Если система перегружена, но еще можем использовать caller-runs
- Если очередь полна, пытаемся освободить место
- В критических ситуациях - кратковременная блокировка
- Последняя мера - отказ

Преимущества:

- Адаптивность - автоматически подстраивается под нагрузку
- Graceful degradation - постепенное снижение производительности вместо резкого отказа
- Защита от потери данных - критические задачи выполняются в caller thread
- Back-pressure - естественное замедление отправителей при перегрузке
- Мониторинг - встроенные метрики для анализа производительности

Недостатки:

- Сложность - более сложная логика, требующая тестирования
- Настройка - требует тонкой настройки параметров для конкретного приложения
- Overhead - дополнительные проверки могут влиять на производительность
- Непредсказуемость - поведение может изменяться в зависимости от нагрузки

## Анализ производительности

Ниже приведены результаты трёх тестов для разных имплементаций, в том числе Custom ThreadPool с разными параметрами для 70 задач

| Implementation                         | Light CPU (10мс CPU) | Light I/O (20мс I/O) | Balanced (10мс I/O + 5мс CPU) |
|----------------------------------------|----------------------|----------------------|-------------------------------|
| Custom ThreadPool 4-8size 60sec 2spare | 10,00                | 23,14                | 16,60                         |
| Custom ThreadPool 4-8size 30sec 2spare | 10,00                | 23,53                | 16,66                         |
| Custom ThreadPool 2-4size 60sec 2spare | 10,02                | 23,63                | 16,76                         |
| Custom ThreadPool 4-8size 60sec 4spare | 10,01                | 23,35                | 16,73                         |
| ThreadPoolExecutor                     | 10,00                | 23,12                | 16,74                         |
| FixedThreadPool(4)                     | 10,00                | 23,25                | 16,90                         |
| CachedThreadPool                       | 10,05                | 23,23                | 32,94                         |

Основные наблюдения:
1. Производительность Custom ThreadPool сопоставима со стандартными решениями
- Результаты Custom ThreadPool очень близки к ThreadPoolExecutor и FixedThreadPool
- Это говорит о корректной реализации основной логики пула
2. Влияние параметров конфигурации минимально
- Изменение keepAliveTime (60→30 сек): практически нет разницы
- Изменение размера пула (4-8 → 2-4): незначительное влияние (+0.5-1%)
- Изменение minSpareThreads (2→4): минимальный эффект
3. Аномалия с CachedThreadPool в Balanced тесте
Это может указывать на:
- Overhead от создания множества потоков
- Неоптимальное поведение при смешанной нагрузке
4. Стабильность результатов
- Большинство результатов в пределах 10-24 мс
- Низкая вариативность между реализациями (±1-2%)
- Это говорит о надежности Custom ThreadPool

Выводы:
- Custom ThreadPool работает корректно - результаты сопоставимы с эталонными реализациями
- Хорошая стабильность - нет значительных провалов производительности
- Адаптивность конфигурации - можно гибко настраивать параметры
- Несколько очередей и алгоритм балансировки не реализован, используется стандартный подход с единой очередью, свободный поток берет следующую задачу